{"ast":null,"code":"import _regeneratorRuntime from\"/home/prado/Desktop/unb/topicos/api_estoque_topicos3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/prado/Desktop/unb/topicos/api_estoque_topicos3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/prado/Desktop/unb/topicos/api_estoque_topicos3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{useState}from\"react\";import{Container,Label,Button,ButtonC,Input,Title,ErrorMsg}from\"./styles\";import{useForm}from\"react-hook-form\";import{useHistory}from\"react-router-dom\";import api from\"../api\";var LoginPage=function LoginPage(){var _useForm=useForm(),handleSubmit=_useForm.handleSubmit,register=_useForm.register;var history=useHistory();// mensagem de erro\nvar _useState=useState(null),_useState2=_slicedToArray(_useState,2),msg=_useState2[0],setMsg=_useState2[1];var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return api.post(\"/login\",data);case 3:response=_context.sent;console.log(response);api.defaults.headers.Authorization=\"Bearer \".concat(response.data.token);localStorage.setItem(\"token\",response.data.token);history.push(\"/home\");_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);setMsg(_context.t0);case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();var goToC=function goToC(){try{history.push(\"/cadastro\");}catch(error){console.log(error);}};return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Title,{children:\" Bem vindo \"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsx(Label,{children:\"E-mail\"}),/*#__PURE__*/_jsx(Input,{name:\"email\",ref:register}),/*#__PURE__*/_jsx(Label,{children:\"Senha\"}),/*#__PURE__*/_jsx(Input,{name:\"senha\",ref:register}),/*#__PURE__*/_jsx(\"p\",{}),/*#__PURE__*/_jsx(Button,{children:\"Login\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),msg&&/*#__PURE__*/_jsx(ErrorMsg,{children:msg})]}),/*#__PURE__*/_jsx(ButtonC,{onClick:handleSubmit(goToC),children:\"Cadastre-se\"})]});};export default LoginPage;","map":{"version":3,"sources":["/home/prado/Desktop/unb/topicos/api_estoque_topicos3/src/pages/Login.js"],"names":["useState","Container","Label","Button","ButtonC","Input","Title","ErrorMsg","useForm","useHistory","api","LoginPage","handleSubmit","register","history","msg","setMsg","onSubmit","data","post","response","console","log","defaults","headers","Authorization","token","localStorage","setItem","push","goToC","error"],"mappings":"slBAAA,OAASA,QAAT,KAAyB,OAAzB,CACA,OAASC,SAAT,CAAoBC,KAApB,CAA2BC,MAA3B,CAAmCC,OAAnC,CAA4CC,KAA5C,CAAmDC,KAAnD,CAA0DC,QAA1D,KAA0E,UAA1E,CACA,OAASC,OAAT,KAAwB,iBAAxB,CACA,OAASC,UAAT,KAA2B,kBAA3B,CAEA,MAAOC,CAAAA,GAAP,KAAgB,QAAhB,CAEA,GAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,cACaH,OAAO,EADpB,CACdI,YADc,UACdA,YADc,CACAC,QADA,UACAA,QADA,CAEtB,GAAMC,CAAAA,OAAO,CAAGL,UAAU,EAA1B,CAEA;AAJsB,cAKAT,QAAQ,CAAC,IAAD,CALR,wCAKfe,GALe,eAKVC,MALU,eAOtB,GAAMC,CAAAA,QAAQ,0FAAG,iBAAOC,IAAP,qKAGUR,CAAAA,GAAG,CAACS,IAAJ,CAAS,QAAT,CAAmBD,IAAnB,CAHV,QAGPE,QAHO,eAIbC,OAAO,CAACC,GAAR,CAAYF,QAAZ,EACAV,GAAG,CAACa,QAAJ,CAAaC,OAAb,CAAqBC,aAArB,kBAA+CL,QAAQ,CAACF,IAAT,CAAcQ,KAA7D,EACAC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8BR,QAAQ,CAACF,IAAT,CAAcQ,KAA5C,EACAZ,OAAO,CAACe,IAAR,CAAa,OAAb,EAPa,iFASbb,MAAM,aAAN,CATa,qEAAH,kBAARC,CAAAA,QAAQ,4CAAd,CAaA,GAAMa,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,EAAM,CAClB,GAAI,CACFhB,OAAO,CAACe,IAAR,CAAa,WAAb,EAED,CAAC,MAAME,KAAN,CAAY,CACZV,OAAO,CAACC,GAAR,CAAYS,KAAZ,EACD,CACF,CAPD,CASA,mBACE,MAAC,SAAD,yBACE,KAAC,KAAD,0BADF,cAEE,cAAM,QAAQ,CAAEnB,YAAY,CAACK,QAAD,CAA5B,wBACE,KAAC,KAAD,qBADF,cAEE,KAAC,KAAD,EAAO,IAAI,CAAC,OAAZ,CAAoB,GAAG,CAAEJ,QAAzB,EAFF,cAGE,KAAC,KAAD,oBAHF,cAIE,KAAC,KAAD,EAAO,IAAI,CAAC,OAAZ,CAAoB,GAAG,CAAEA,QAAzB,EAJF,cAKE,YALF,cAME,KAAC,MAAD,oBANF,cAOE,aAPF,cAQE,aARF,CASGE,GAAG,eAAI,KAAC,QAAD,WAAWA,GAAX,EATV,GAFF,cAaI,KAAC,OAAD,EAAS,OAAO,CAAEH,YAAY,CAACkB,KAAD,CAA9B,yBAbJ,GADF,CAiBD,CA9CD,CAgDA,cAAenB,CAAAA,SAAf","sourcesContent":["import { useState } from \"react\";\nimport { Container, Label, Button, ButtonC, Input, Title, ErrorMsg } from \"./styles\";\nimport { useForm } from \"react-hook-form\";\nimport { useHistory } from \"react-router-dom\";\n\nimport api from \"../api\";\n\nconst LoginPage = () => {\n  const { handleSubmit, register } = useForm();\n  const history = useHistory();\n\n  // mensagem de erro\n  const [msg, setMsg] = useState(null);\n\n  const onSubmit = async (data) => {\n    try {\n      // data = {email, pwd}\n      const response = await api.post(\"/login\", data);\n      console.log(response);\n      api.defaults.headers.Authorization = `Bearer ${response.data.token}`;\n      localStorage.setItem(\"token\", response.data.token)\n      history.push(\"/home\");\n    } catch (error) {\n      setMsg(error);\n    }\n  };\n\n  const goToC = () => {\n    try {\n      history.push(\"/cadastro\");\n\n    } catch(error){\n      console.log(error)\n    }\n  }\n\n  return (\n    <Container>\n      <Title> Bem vindo </Title>\n      <form onSubmit={handleSubmit(onSubmit)}>\n        <Label>E-mail</Label>\n        <Input name=\"email\" ref={register} />\n        <Label>Senha</Label>\n        <Input name=\"senha\" ref={register} />\n        <p />\n        <Button>Login</Button>\n        <br/>\n        <br/>\n        {msg && <ErrorMsg>{msg}</ErrorMsg>}\n      </form>\n        <ButtonC onClick={handleSubmit(goToC)}>Cadastre-se</ButtonC>\n    </Container>\n  );\n};\n\nexport default LoginPage;\n"]},"metadata":{},"sourceType":"module"}